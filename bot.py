import os
import asyncio
import logging
from typing import Dict, Any, List
from datetime import date

from dotenv import load_dotenv
from aiogram import Bot, Dispatcher, F
from aiogram.types import (
    Message,
    Document,
    ReplyKeyboardMarkup,
    KeyboardButton,
)
from aiogram.filters import CommandStart, Command

import openai
from PyPDF2 import PdfReader
from docx import Document as DocxDocument

load_dotenv()

BOT_TOKEN = os.getenv("BOT_TOKEN")
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")

if not BOT_TOKEN:
    raise RuntimeError("BOT_TOKEN –Ω–µ –∑–∞–¥–∞–Ω")
if not OPENAI_API_KEY:
    raise RuntimeError("OPENAI_API_KEY –Ω–µ –∑–∞–¥–∞–Ω")

openai.api_key = OPENAI_API_KEY

logging.basicConfig(level=logging.INFO)

bot = Bot(token=BOT_TOKEN)
dp = Dispatcher()

user_states: Dict[int, str] = {}
user_data: Dict[int, Dict[str, Any]] = {}
user_limits: Dict[int, Dict[str, Any]] = {}

DAILY_LIMIT_REQUESTS = 50


class States:
    NONE = "NONE"

    CAREER_ASK_AGE = "CAREER_ASK_AGE"
    CAREER_ASK_EDU = "CAREER_ASK_EDU"
    CAREER_ASK_SKILLS = "CAREER_ASK_SKILLS"
    CAREER_ASK_EXP = "CAREER_ASK_EXP"
    CAREER_ASK_GOAL = "CAREER_ASK_GOAL"

    RESUME_ASK_ROLE = "RESUME_ASK_ROLE"
    RESUME_ASK_CONTACTS = "RESUME_ASK_CONTACTS"
    RESUME_ASK_CITY = "RESUME_ASK_CITY"
    RESUME_ASK_EDU = "RESUME_ASK_EDU"
    RESUME_ASK_EXP = "RESUME_ASK_EXP"
    RESUME_ASK_SKILLS = "RESUME_ASK_SKILLS"
    RESUME_ASK_ACH = "RESUME_ASK_ACH"
    RESUME_ASK_EXTRA = "RESUME_ASK_EXTRA"

    RESCHECK_ASK_ROLE = "RESCHECK_ASK_ROLE"
    RESCHECK_WAIT_TEXT = "RESCHECK_WAIT_TEXT"

    HRMOCK_ASK_ROLE = "HRMOCK_ASK_ROLE"
    HRMOCK_Q = "HRMOCK_Q"

    PLAN_ASK_ROLE = "PLAN_ASK_ROLE"
    PLAN_ASK_COMPANY = "PLAN_ASK_COMPANY"
    PLAN_ASK_FEARS = "PLAN_ASK_FEARS"
    PLAN_ASK_STRENGTHS = "PLAN_ASK_STRENGTHS"
    PLAN_ASK_EXTRA = "PLAN_ASK_EXTRA"

    SYMBIO_ASK_NAME = "SYMBIO_ASK_NAME"
    SYMBIO_ASK_AGE = "SYMBIO_ASK_AGE"
    SYMBIO_ASK_ROLE = "SYMBIO_ASK_ROLE"
    SYMBIO_ASK_EXP = "SYMBIO_ASK_EXP"
    SYMBIO_ASK_SKILLS = "SYMBIO_ASK_SKILLS"
    SYMBIO_ASK_FEARS = "SYMBIO_ASK_FEARS"
    SYMBIO_ASK_EXTRA = "SYMBIO_ASK_EXTRA"

    SOFT_Q1 = "SOFT_Q1"
    SOFT_Q2 = "SOFT_Q2"
    SOFT_Q3 = "SOFT_Q3"
    SOFT_Q4 = "SOFT_Q4"

    VACANCY_WAIT_TEXT = "VACANCY_WAIT_TEXT"
    VACANCY_WAIT_PROFILE = "VACANCY_WAIT_PROFILE"


HR_INTRO_QUESTIONS: List[str] = [
    "–†–∞—Å—Å–∫–∞–∂–∏ –∫—Ä–∞—Ç–∫–æ –æ —Å–µ–±–µ –∫–∞–∫ –æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–µ.",
    "–ü–æ—á–µ–º—É —Ç—ã —Ö–æ—á–µ—à—å —Ä–∞–±–æ—Ç–∞—Ç—å –∏–º–µ–Ω–Ω–æ –Ω–∞ —ç—Ç–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ –≤ —ç—Ç–æ–π —Å—Ñ–µ—Ä–µ?",
    "–ö–∞–∫–∏–µ —Ç–≤–æ–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –¥–ª—è —ç—Ç–æ–π —Ä–æ–ª–∏?",
    "–†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–ª–æ–∂–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –Ω–∞ —É—á—ë–±–µ –∏–ª–∏ —Ä–∞–±–æ—Ç–µ –∏ –∫–∞–∫ —Ç—ã –µ—ë —Ä–µ—à–∏–ª(–∞).",
    "–ö–∞–∫ —Ç—ã —Ä–∞–±–æ—Ç–∞–µ—à—å –≤ –∫–æ–º–∞–Ω–¥–µ? –ü—Ä–∏–≤–µ–¥–∏ –ø—Ä–∏–º–µ—Ä.",
    "–ö–∞–∫ —Ç—ã —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è —Å–æ —Å—Ç—Ä–µ—Å—Å–æ–º –∏ –¥–µ–¥–ª–∞–π–Ω–∞–º–∏?",
    "–ö–∞–∫–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç—ã —Ö–æ—Ç–µ–ª(–∞) –±—ã –¥–æ—Å—Ç–∏—á—å —á–µ—Ä–µ–∑ 1‚Äì2 –≥–æ–¥–∞?",
]

PROMPT_CAREER = """
–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –∫–∞—Ä—å–µ—Ä–Ω–æ–º—É –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –≤ –†–§ —É—Ä–æ–≤–Ω—è Senior.

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–°–¥–µ–ª–∞–π:

1) –ü–æ—Ä—Ç—Ä–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
   ‚Ä¢ —Å—Ç–∏–ª—å –º—ã—à–ª–µ–Ω–∏—è,
   ‚Ä¢ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã,
   ‚Ä¢ —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏ –∑–æ–Ω—ã —Ä–æ—Å—Ç–∞,
   ‚Ä¢ –º–æ—Ç–∏–≤–∞—Ü–∏—é,
   ‚Ä¢ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ —Ä–∏—Å–∫—É –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏.

2) –ê–Ω–∞–ª–∏–∑ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –æ–ø—ã—Ç–∞:
   ‚Ä¢ –∫–∞–∫ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—Ä—å–µ—Ä—É,
   ‚Ä¢ –∫–∞–∫–∏–µ –≤—ã–≤–æ–¥—ã –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∏–∑ –æ–ø—ã—Ç–∞,
   ‚Ä¢ –∫–∞–∫–∏–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏ —É–∂–µ –µ—Å—Ç—å.

3) –ü–æ–¥–±–æ—Ä 7‚Äì12 –ø—Ä–æ—Ñ–µ—Å—Å–∏–π/–¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π –≤ –†–§:
   –î–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ —É–∫–∞–∂–∏:
   ‚Ä¢ –Ω–∞–∑–≤–∞–Ω–∏–µ,
   ‚Ä¢ 3‚Äì7 –ø—Ä–∏—á–∏–Ω, –ø–æ—á–µ–º—É –æ–Ω–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç,
   ‚Ä¢ –∫–∞–∫–∏–µ –Ω–∞–≤—ã–∫–∏ —É–∂–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç,
   ‚Ä¢ –∫–∞–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç,
   ‚Ä¢ —É—Ä–æ–≤–µ–Ω—å –≤—Ö–æ–¥–∞ (–±–µ–∑ –æ–ø—ã—Ç–∞ / –Ω–∞—á–∏–Ω–∞—é—â–∏–π / junior),
   ‚Ä¢ –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –¥–æ—Ö–æ–¥ (–¥–∏–∞–ø–∞–∑–æ–Ω) –≤ –†–§.

4) –ê–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ–π:
   ‚Ä¢ –Ω–∞—Å–∫–æ–ª—å–∫–æ –∑–∞—è–≤–ª–µ–Ω–Ω—ã–µ —Ü–µ–ª–∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã,
   ‚Ä¢ –∫–∞–∫–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è –∏–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç,
   ‚Ä¢ –∫–∞–∫–∏–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã.

5) –ü–ª–∞–Ω –Ω–∞ 30 –¥–Ω–µ–π:
   ‚Ä¢ —á–µ–º—É —É—á–∏—Ç—å—Å—è,
   ‚Ä¢ —á—Ç–æ –¥–µ–ª–∞—Ç—å –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é,
   ‚Ä¢ –∫–∞–∫–∏–µ —à–∞–≥–∏ –¥–∞–¥—É—Ç –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å,
   ‚Ä¢ –∫–∞–∫ –∏—Å–∫–∞—Ç—å –ø–µ—Ä–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (—Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏, –ø—Ä–∞–∫—Ç–∏–∫–∞, –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏).

6) –û—Ü–µ–Ω–∫–∞ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π:
   ‚Ä¢ –∫–∞–∫–∏–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏ —Å–∏–ª—å–Ω—ã–µ,
   ‚Ä¢ –∫–∞–∫–∏–µ —Å–ª–∞–±—ã–µ,
   ‚Ä¢ —á—Ç–æ –ª—É—á—à–µ –ø—Ä–æ–∫–∞—á–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å.

7) –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
   ‚Ä¢ —á–µ–≥–æ –ª—É—á—à–µ –∏–∑–±–µ–≥–∞—Ç—å,
   ‚Ä¢ –∫–∞–∫ –Ω–µ –º–µ—à–∞—Ç—å —Å–µ–±–µ.

–ü–∏—à–∏ –ø–æ-—Ä—É—Å—Å–∫–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ, –∂–∏–≤—ã–º, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º —è–∑—ã–∫–æ–º.
"""

PROMPT_RESUME = """
–¢—ã ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π HR –∏ –∫–∞—Ä—å–µ—Ä–Ω—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç —É—Ä–æ–≤–Ω—è Senior –≤ –†–§.

–°–æ—Å—Ç–∞–≤—å —Å–∏–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ –ø–æ–¥ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–æ–ª–∂–Ω–æ—Å—Ç—å.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:

1) –ó–∞–≥–æ–ª–æ–≤–æ–∫:
   ‚Ä¢ –¥–æ–ª–∂–Ω–æ—Å—Ç—å –∫–æ—Ä–æ—Ç–∫–æ –∏ —ë–º–∫–æ.

2) –ö—Ä–∞—Ç–∫–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (3‚Äì6 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π):
   ‚Ä¢ –∫—Ç–æ –∫–∞–Ω–¥–∏–¥–∞—Ç,
   ‚Ä¢ –µ–≥–æ –∫–ª—é—á–µ–≤–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è,
   ‚Ä¢ —Ç–∏–ø –∑–∞–¥–∞—á, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω —Å–ø–æ—Å–æ–±–µ–Ω –∑–∞–∫—Ä—ã–≤–∞—Ç—å,
   ‚Ä¢ —É—Ä–æ–≤–µ–Ω—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏,
   ‚Ä¢ —á–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –¥—Ä—É–≥–∏—Ö.

3) –ö–ª—é—á–µ–≤—ã–µ –Ω–∞–≤—ã–∫–∏:
   ‚Ä¢ Hard skills ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —É–º–µ–Ω–∏—è,
   ‚Ä¢ Soft skills ‚Äî –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏.

4) –û–ø—ã—Ç (–¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω —É—á–µ–±–Ω—ã–π/–ø—Ä–æ–µ–∫—Ç–Ω—ã–π):
   –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–∞ —É–∫–∞–∂–∏:
   ‚Ä¢ –¥–æ–ª–∂–Ω–æ—Å—Ç—å / —Ä–æ–ª—å,
   ‚Ä¢ –∫–æ–Ω—Ç–µ–∫—Å—Ç (–∫–æ–º–ø–∞–Ω–∏—è, –ø—Ä–æ–µ–∫—Ç, —É—á–µ–±–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å),
   ‚Ä¢ 3‚Äì6 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π –∏ –∑–∞–¥–∞—á,
   ‚Ä¢ 3‚Äì6 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å —Ü–∏—Ñ—Ä–∞–º–∏, —Ä–æ—Å—Ç–æ–º, –ø—Ä–∏–º–µ—Ä–∞–º–∏).

5) –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:
   ‚Ä¢ —É—á–µ–±–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è,
   ‚Ä¢ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è,
   ‚Ä¢ –∫–ª—é—á–µ–≤—ã–µ –∫—É—Ä—Å—ã/–º–æ–¥—É–ª–∏, –µ—Å–ª–∏ –æ–Ω–∏ –≤–∞–∂–Ω—ã –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏.

6) –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:
   ‚Ä¢ –ø—Ä–æ–µ–∫—Ç—ã,
   ‚Ä¢ –∫–æ–Ω–∫—É—Ä—Å—ã,
   ‚Ä¢ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã,
   ‚Ä¢ —É–ª—É—á—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Å–¥–µ–ª–∞–ª –∫–∞–Ω–¥–∏–¥–∞—Ç.

7) –ö—É—Ä—Å—ã, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ.

8) –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
   ‚Ä¢ —è–∑—ã–∫–∏,
   ‚Ä¢ –≤–ª–∞–¥–µ–Ω–∏–µ –ü–û,
   ‚Ä¢ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø–µ—Ä–µ–µ–∑–¥—É –∏–ª–∏ —É–¥–∞–ª—ë–Ω–∫–µ,
   ‚Ä¢ –≤–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏.

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
‚Ä¢ –ù–µ –≤—ã–¥—É–º—ã–≤–∞–π –æ–ø—ã—Ç –∏ –º–µ—Å—Ç–∞ —Ä–∞–±–æ—Ç—ã ‚Äî —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π –∏ —É—Å–∏–ª–∏–≤–∞–π —Ç–æ, —á—Ç–æ –¥–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.
‚Ä¢ –§–æ—Ä–º—É–ª–∏—Ä—É–π –∫—Ä–∞—Ç–∫–æ, —Å–∏–ª—å–Ω–æ, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ, –±–µ–∑ –ø—É—Å—Ç—ã—Ö –æ–±—â–∏—Ö —Ñ—Ä–∞–∑.
‚Ä¢ –†–µ–∑—é–º–µ –¥–æ–ª–∂–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã—Ö HR –∏ —Å–∏—Å—Ç–µ–º—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.
"""

PROMPT_RESCHECK = """
–¢—ã ‚Äî Senior HR –∏ –∫–∞—Ä—å–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫.

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ä–µ–∑—é–º–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –∏ —Å–¥–µ–ª–∞–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä.

–°–¥–µ–ª–∞–π:

1) –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ 10-–±–∞–ª–ª—å–Ω–æ–π —à–∫–∞–ª–µ –∏ –ø–µ—Ä–≤–æ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ (1‚Äì2 –∞–±–∑–∞—Ü–∞).

2) –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã —Ä–µ–∑—é–º–µ:
   ‚Ä¢ —á—Ç–æ —É–∂–µ —Ö–æ—Ä–æ—à–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–æ,
   ‚Ä¢ –∫–∞–∫–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ —Å–∏–ª—å–Ω—ã–µ,
   ‚Ä¢ —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–Ω—Ä–∞–≤–∏—Ç—å—Å—è HR.

3) –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏ –æ—à–∏–±–∫–∏:
   ‚Ä¢ –Ω–µ—Å–≤—è–∑–Ω–æ—Å—Ç—å, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞,
   ‚Ä¢ —Å–ª–∏—à–∫–æ–º –æ–±—â–∏–µ –∏–ª–∏ –ø—É—Å—Ç—ã–µ —Ñ—Ä–∞–∑—ã,
   ‚Ä¢ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤,
   ‚Ä¢ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–∞–ª—ã,
   ‚Ä¢ –ª–∏—à–Ω—è—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.

4) –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
   ‚Ä¢ 6‚Äì12 –ø—É–Ω–∫—Ç–æ–≤, —á—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å, –¥–æ–±–∞–≤–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å,
   ‚Ä¢ –∫–∞–∫ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∞–±—ã–µ —Ñ—Ä–∞–∑—ã,
   ‚Ä¢ –∫–∞–∫–∏–µ –±–ª–æ–∫–∏ —É—Å–∏–ª–∏—Ç—å.

5) –û—Ü–µ–Ω–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏:
   ‚Ä¢ —á–µ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–ª—è —ç—Ç–æ–π —Ä–æ–ª–∏,
   ‚Ä¢ –∫–∞–∫–∏–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏ –Ω—É–∂–Ω–æ –ø–æ–¥—Ç—è–Ω—É—Ç—å.

6) –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ä–µ–∑—é–º–µ:
   ‚Ä¢ –ø–µ—Ä–µ–ø–∏—à–∏ —Ä–µ–∑—é–º–µ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–æ –±—ã–ª–æ —Å–∏–ª—å–Ω–µ–µ,
   ‚Ä¢ –Ω–µ –ø—Ä–∏–¥—É–º—ã–≤–∞–π –æ–ø—ã—Ç, –∞ —Ç–æ–ª—å–∫–æ —É—Å–∏–ª–∏–≤–∞–π —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É.

–ü–∏—à–∏ –ø–æ-—Ä—É—Å—Å–∫–∏, —á–µ—Å—Ç–Ω–æ –∏ –ø–æ –¥–µ–ª—É, —Å —É–≤–∞–∂–µ–Ω–∏–µ–º –∫ –∫–∞–Ω–¥–∏–¥–∞—Ç—É.
"""

PROMPT_MOCK = """
–¢—ã ‚Äî Senior HR –∏ –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä.

–ü–µ—Ä–µ–¥ —Ç–æ–±–æ–π –æ—Ç–≤–µ—Ç—ã –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è. –ü—Ä–æ–≤–µ–¥–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä.

–°–¥–µ–ª–∞–π:

1) –û–±—â–µ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ:
   ‚Ä¢ –∫–∞–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç,
   ‚Ä¢ –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π –∏ –º–æ—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π.

2) –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤:
   ‚Ä¢ –≥–¥–µ –æ–Ω –∑–≤—É—á–∏—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ,
   ‚Ä¢ –∫–∞–∫–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ —É–¥–∞—á–Ω—ã–µ,
   ‚Ä¢ —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–Ω—Ä–∞–≤–∏—Ç—å—Å—è –Ω–∞–Ω–∏–º–∞—é—â–µ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É.

3) –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:
   ‚Ä¢ –≥–¥–µ –∫–∞–Ω–¥–∏–¥–∞—Ç –ø—É—Ç–∞–µ—Ç—Å—è,
   ‚Ä¢ –≥–¥–µ –≥–æ–≤–æ—Ä–∏—Ç —Å–ª–∏—à–∫–æ–º –æ–±—â–æ –∏–ª–∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ,
   ‚Ä¢ –≥–¥–µ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–ª–∏ –ø—Ä–∏–º–µ—Ä–æ–≤.

4) –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
   ‚Ä¢ –ø—Ä–µ–¥–ª–æ–∂–∏ –±–æ–ª–µ–µ —Å–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏,
   ‚Ä¢ –ø–æ–∫–∞–∂–∏, –∫–∞–∫ –º–æ–∂–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å –ª—É—á—à–µ,
   ‚Ä¢ –¥–∞–π –ø—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –±–ª–∏–∑–∫–æ–º –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—é.

5) –û—Ü–µ–Ω–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—é:
   ‚Ä¢ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å,
   ‚Ä¢ –ª–æ–≥–∏–∫–∞,
   ‚Ä¢ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º—ã—à–ª–µ–Ω–∏—è,
   ‚Ä¢ —É–º–µ–Ω–∏–µ –ø—Ä–µ–∑–µ–Ω—Ç–æ–≤–∞—Ç—å —Å–µ–±—è,
   ‚Ä¢ –∏—Ç–æ–≥ –ø–æ 10-–±–∞–ª–ª—å–Ω–æ–π —à–∫–∞–ª–µ.

6) –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã:
   ‚Ä¢ —á—Ç–æ –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å,
   ‚Ä¢ –∫–∞–∫ –≤–µ—Å—Ç–∏ —Å–µ–±—è –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏,
   ‚Ä¢ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–æ–ª–Ω–µ–Ω–∏–µ–º.

–ü–∏—à–∏ –ø–æ-—Ä—É—Å—Å–∫–∏, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ.
"""

PROMPT_PLAN = """
–¢—ã ‚Äî –∫–∞—Ä—å–µ—Ä–Ω—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –∏ HR —É—Ä–æ–≤–Ω—è Senior.

–°–æ—Å—Ç–∞–≤—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ–≤–µ–¥–µ–Ω–∏—è –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –ø–æ–¥ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–æ–ª–∂–Ω–æ—Å—Ç—å.

–°–¥–µ–ª–∞–π:

1) –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è:
   ‚Ä¢ –∫–∞–∫ –ª—É—á—à–µ –¥–µ—Ä–∂–∞—Ç—å—Å—è,
   ‚Ä¢ –∫–∞–∫–∏–µ –∏–Ω—Ç–æ–Ω–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å,
   ‚Ä¢ –æ–±—â–∏–π —Ç–æ–Ω (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π / –∂–∏–≤–æ–π / —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –∏ —Ç.–¥.).

2) –ù–∞ –∫–∞–∫–∏–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –¥–µ–ª–∞—Ç—å –∞–∫—Ü–µ–Ω—Ç:
   ‚Ä¢ –∫–∞–∫ –∏—Ö —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å,
   ‚Ä¢ –≤ –∫–∞–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö –∏—Ö –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–∫–∞–∑–∞—Ç—å.

3) –ö–∞–∫ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –ø–æ–¥–∞–≤–∞—Ç—å —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:
   ‚Ä¢ –∫–∞–∫ –≥–æ–≤–æ—Ä–∏—Ç—å –æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–º –æ–ø—ã—Ç–µ,
   ‚Ä¢ –∫–∞–∫ —É–ø–æ–º–∏–Ω–∞—Ç—å –ø—Ä–æ–≤–∞–ª—ã —Ç–∞–∫, —á—Ç–æ–±—ã –Ω–µ –Ω–∞–≤—Ä–µ–¥–∏—Ç—å —Å–µ–±–µ.

4) 15 —Ç–∏–ø–∏—á–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ HR –ø–æ–¥ —ç—Ç—É –¥–æ–ª–∂–Ω–æ—Å—Ç—å —Å –ø—Ä–∏–º–µ—Ä–Ω—ã–º–∏ —Å–∏–ª—å–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏.

5) 10 –∫–∞–≤–µ—Ä–∑–Ω—ã—Ö –∏–ª–∏ —Å–ª–æ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤:
   ‚Ä¢ –∑–∞—á–µ–º –∏—Ö –∑–∞–¥–∞—é—Ç,
   ‚Ä¢ –∫–∞–∫–æ–≤–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ—Ç–≤–µ—Ç–∞,
   ‚Ä¢ –ø—Ä–∏–º–µ—Ä—ã —Ö–æ—Ä–æ—à–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤.

6) –û—à–∏–±–∫–∏:
   ‚Ä¢ —á—Ç–æ –¥–µ–ª–∞—Ç—å –Ω–µ–ª—å–∑—è,
   ‚Ä¢ —Ñ—Ä–∞–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ –ª—É—á—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å,
   ‚Ä¢ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç—Ç–æ–ª–∫–Ω—É—Ç—å.

7) –°–æ–≤–µ—Ç—ã –ø–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏:
   ‚Ä¢ –∫–∞–∫ —Å–Ω–∏–∑–∏—Ç—å –≤–æ–ª–Ω–µ–Ω–∏–µ,
   ‚Ä¢ –±–∞–∑–æ–≤—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –¥—ã—Ö–∞–Ω–∏—è –∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏,
   ‚Ä¢ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å—Å—è –Ω–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä.

–ü–∏—à–∏ –ø–æ-—Ä—É—Å—Å–∫–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ.
"""

PROMPT_SYMBIO = """
–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∫–∞—Ä—å–µ—Ä–µ, HR –∏ —Ä–µ–∑—é–º–µ —É—Ä–æ–≤–Ω—è Senior.

–°–¥–µ–ª–∞–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ç—á—ë—Ç ¬´–ü—É—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞¬ª –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:

1) –ü–æ—Ä—Ç—Ä–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–∞:
   ‚Ä¢ —Å—Ç–∏–ª—å –º—ã—à–ª–µ–Ω–∏—è,
   ‚Ä¢ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã,
   ‚Ä¢ –∑–æ–Ω—ã —Ä–æ—Å—Ç–∞,
   ‚Ä¢ –º–æ—Ç–∏–≤–∞—Ü–∏—è,
   ‚Ä¢ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è.

2) –ü–æ–¥–±–æ—Ä 5‚Äì10 –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø—Ä–æ—Ñ–µ—Å—Å–∏–π –∏–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
   ‚Ä¢ –ø–æ—á–µ–º—É –∫–∞–∂–¥–∞—è –ø—Ä–æ—Ñ–µ—Å—Å–∏—è –ø–æ–¥—Ö–æ–¥–∏—Ç,
   ‚Ä¢ –∫–∞–∫–∏–µ –Ω–∞–≤—ã–∫–∏ —É–∂–µ –µ—Å—Ç—å,
   ‚Ä¢ –∫–∞–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç,
   ‚Ä¢ —É—Ä–æ–≤–µ–Ω—å –≤—Ö–æ–¥–∞,
   ‚Ä¢ –ø—Ä–∏–º–µ—Ä–Ω—ã–π —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –¥–æ—Ö–æ–¥.

3) –ß–µ—Ä–Ω–æ–≤–∏–∫ —Ä–µ–∑—é–º–µ –ø–æ–¥ —Ü–µ–ª–µ–≤—É—é –¥–æ–ª–∂–Ω–æ—Å—Ç—å:
   ‚Ä¢ –∫—Ä–∞—Ç–∫–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ,
   ‚Ä¢ –∫–ª—é—á–µ–≤—ã–µ –Ω–∞–≤—ã–∫–∏,
   ‚Ä¢ –æ–ø—ã—Ç –∏ –ø—Ä–æ–µ–∫—Ç—ã,
   ‚Ä¢ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ,
   ‚Ä¢ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.

4) –ö—Ä–∞—Ç–∫–∏–π —Ä–∞–∑–±–æ—Ä —Ä–µ–∑—é–º–µ:
   ‚Ä¢ —á—Ç–æ —Ö–æ—Ä–æ—à–æ,
   ‚Ä¢ —á—Ç–æ —Å—Ç–æ–∏—Ç —É–ª—É—á—à–∏—Ç—å,
   ‚Ä¢ 3‚Äì6 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

5) –ü–ª–∞–Ω –ø–æ–≤–µ–¥–µ–Ω–∏—è –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏:
   ‚Ä¢ —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è,
   ‚Ä¢ –∞–∫—Ü–µ–Ω—Ç—ã –Ω–∞ —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö,
   ‚Ä¢ –∫–∞–∫ –ø–æ–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã.

6) 10 –ø—Ä–∏–º–µ—Ä–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ HR –ø–æ–¥ —ç—Ç—É —Ä–æ–ª—å + –ø—Ä–∏–º–µ—Ä–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.

7) –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ 30 –¥–Ω–µ–π:
   ‚Ä¢ —á—Ç–æ –¥–µ–ª–∞—Ç—å –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é,
   ‚Ä¢ —á–µ–º—É —É—á–∏—Ç—å—Å—è,
   ‚Ä¢ –∫–∞–∫ –∏—Å–∫–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.

–ü–∏—à–∏ –ø–æ-—Ä—É—Å—Å–∫–∏, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ.
"""

PROMPT_SOFT = """
–¢—ã ‚Äî –∫–∞—Ä—å–µ—Ä–Ω—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –∏ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –≥—Ä–∞–º–æ—Ç–Ω—ã–π HR.

–ü–µ—Ä–µ–¥ —Ç–æ–±–æ–π –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –∏ soft skills.

–°–¥–µ–ª–∞–π:

1) –û–±—â–∏–π –ø—Ä–æ—Ñ–∏–ª—å:
   ‚Ä¢ —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è,
   ‚Ä¢ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º,
   ‚Ä¢ —Ä–∞–±–æ—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥–µ,
   ‚Ä¢ —Å—Ç–∏–ª—å —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á,
   ‚Ä¢ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–µ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.

2) –û—Ü–µ–Ω–∫—É –∫–ª—é—á–µ–≤—ã—Ö soft skills –ø–æ —à–∫–∞–ª–µ –æ—Ç 1 –¥–æ 10:
   ‚Ä¢ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è,
   ‚Ä¢ –∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞,
   ‚Ä¢ —Å—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å,
   ‚Ä¢ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å,
   ‚Ä¢ —Å–∞–º–æ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è,
   ‚Ä¢ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.

3) –ê–Ω–∞–ª–∏–∑ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ —Ü–µ–ª–µ–π (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ –æ—Ç–≤–µ—Ç–∞—Ö):
   ‚Ä¢ –∫–∞–∫–∏–µ –≤—ã–≤–æ–¥—ã –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å,
   ‚Ä¢ –∫–∞–∫ –æ–Ω–∏ —Å–≤—è–∑–∞–Ω—ã —Å soft skills.

4) –í—ã–≤–æ–¥—ã:
   ‚Ä¢ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã,
   ‚Ä¢ —Å–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã,
   ‚Ä¢ —Ä–∏—Å–∫–∏ –≤ —Ä–∞–±–æ—Ç–µ –∏ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è—Ö.

5) –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
   ‚Ä¢ —á—Ç–æ –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å –¥–µ–ª–∞—Ç—å —É–∂–µ —Å–µ–π—á–∞—Å,
   ‚Ä¢ –∫–∞–∫–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ —Å—Ç–æ–∏—Ç —Ä–∞–∑–≤–∏—Ç—å,
   ‚Ä¢ –∫–∞–∫ –ø—Ä–æ–∫–∞—á–∞—Ç—å —Å–ª–∞–±—ã–µ soft skills.

–ü–∏—à–∏ –ø–æ-—Ä—É—Å—Å–∫–∏, –º—è–≥–∫–æ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ, –Ω–æ —á–µ—Å—Ç–Ω–æ.
"""

PROMPT_VACANCY = """
–¢—ã ‚Äî Senior HR –∏ –∫–∞—Ä—å–µ—Ä–Ω—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç.

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –≤–∞–∫–∞–Ω—Å–∏—é –∏ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–°–¥–µ–ª–∞–π:

1) –ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏, –∫–æ–≥–æ –∏—â–µ—Ç —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å –ø–æ —ç—Ç–æ–π –≤–∞–∫–∞–Ω—Å–∏–∏.

2) –°–æ–ø–æ—Å—Ç–∞–≤—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–∏ –∏ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
   ‚Ä¢ –∫–∞–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —É–∂–µ –∑–∞–∫—Ä—ã—Ç—ã,
   ‚Ä¢ –∫–∞–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤ –∏ –æ–ø—ã—Ç–∞ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç.

3) –î–∞–π –æ—Ü–µ–Ω–∫—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è (match) –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç 0 –¥–æ 100%.

4) –î–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
   ‚Ä¢ —á—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞–≤—ã–∫–∏ –∏ –æ–ø—ã—Ç,
   ‚Ä¢ –∫–∞–∫ –º–æ–∂–Ω–æ –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π –æ–ø—ã—Ç.

5) –°–æ—Å—Ç–∞–≤—å –∫–æ—Ä–æ—Ç–∫–∏–π –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—Ç–∫–ª–∏–∫–∞ –∏–ª–∏ —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∏—Å—å–º–∞:
   ‚Ä¢ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ HR,
   ‚Ä¢ –ø–æ—á–µ–º—É –∫–∞–Ω–¥–∏–¥–∞—Ç –ø–æ–¥—Ö–æ–¥–∏—Ç,
   ‚Ä¢ –∫–∞–∫—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å –æ–Ω –º–æ–∂–µ—Ç –¥–∞—Ç—å,
   ‚Ä¢ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å—é –∫ –æ–±—â–µ–Ω–∏—é.

–ü–∏—à–∏ –ø–æ-—Ä—É—Å—Å–∫–∏, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ.
"""


async def send_long_message(message: Message, text: str, reply_markup=None):
    if not text:
        return
    limit = 4000
    parts = [text[i:i + limit] for i in range(0, len(text), limit)]
    for i, part in enumerate(parts):
        if i == len(parts) - 1:
            await message.answer(part, reply_markup=reply_markup)
        else:
            await message.answer(part)


def set_state(user_id: int, state: str) -> None:
    user_states[user_id] = state


def get_state(user_id: int) -> str:
    return user_states.get(user_id, States.NONE)


def get_user_data(user_id: int) -> Dict[str, Any]:
    if user_id not in user_data:
        user_data[user_id] = {}
    return user_data[user_id]


def check_limit(user_id: int) -> bool:
    today = date.today().isoformat()
    info = user_limits.get(user_id)
    if not info or info.get("date") != today:
        user_limits[user_id] = {"date": today, "count": 0}
        return True
    if info["count"] >= DAILY_LIMIT_REQUESTS:
        return False
    return True


def inc_limit(user_id: int) -> None:
    today = date.today().isoformat()
    info = user_limits.get(user_id)
    if not info or info.get("date") != today:
        user_limits[user_id] = {"date": today, "count": 1}
    else:
        info["count"] += 1
        user_limits[user_id] = info


async def call_openai_chat(system_prompt: str, user_prompt: str, temperature: float = 0.5) -> str:
    try:
        response = await asyncio.to_thread(
            openai.ChatCompletion.create,
            model="gpt-4o",
            messages=[
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": user_prompt},
            ],
            temperature=temperature,
        )
        return response["choices"][0]["message"]["content"].strip()
    except Exception as e:
        logging.exception("OpenAI error")
        return f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –ò–ò: {e}"


def extract_text_from_file(path: str) -> str:
    path_lower = path.lower()
    try:
        if path_lower.endswith(".pdf"):
            reader = PdfReader(path)
            pages_text = [page.extract_text() or "" for page in reader.pages]
            return "\n".join(pages_text).strip()
        if path_lower.endswith(".docx"):
            doc = DocxDocument(path)
            paragraphs = [p.text for p in doc.paragraphs]
            return "\n".join(paragraphs).strip()
        with open(path, "r", encoding="utf-8", errors="ignore") as f:
            return f.read().strip()
    except Exception as e:
        logging.exception("file parse error")
        return f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª: {e}"


def main_keyboard() -> ReplyKeyboardMarkup:
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="üß≠ –ü–æ–¥–±–æ—Ä –ø—Ä–æ—Ñ–µ—Å—Å–∏–π"), KeyboardButton(text="üìÑ –°–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∑—é–º–µ")],
            [KeyboardButton(text="üßæ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—é–º–µ"), KeyboardButton(text="üé§ HR-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ")],
            [KeyboardButton(text="üéØ –ü–ª–∞–Ω —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è"), KeyboardButton(text="üåÄ –°–∏–º–±–∏–æ–∑ —É—Å–ª—É–≥")],
            [KeyboardButton(text="üß† Soft Skills"), KeyboardButton(text="üìä –ê–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏")],
            [KeyboardButton(text="‚Ñπ –ò–Ω—Ñ–æ"), KeyboardButton(text="üìú –£—Å–ª–æ–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è")],
        ],
        resize_keyboard=True,
    )


@dp.message(CommandStart())
async def cmd_start(message: Message):
    get_user_data(message.from_user.id).clear()
    set_state(message.from_user.id, States.NONE)
    await message.answer(
        "–ü—Ä–∏–≤–µ—Ç! –Ø –∫–∞—Ä—å–µ—Ä–Ω—ã–π AI-–±–æ—Ç.\n\n"
        "–ü–æ–º–æ–≥—É —Å –≤—ã–±–æ—Ä–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è, —Ä–µ–∑—é–º–µ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π –∫ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è–º.\n\n"
        "–í—ã–±–µ—Ä–∏ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –º–µ–Ω—é –Ω–∏–∂–µ.",
        reply_markup=main_keyboard(),
    )


@dp.message(Command("help"))
async def cmd_help(message: Message):
    await message.answer(
        "–Ø –ø–æ–º–æ–≥—É —Ç–µ–±–µ —Å –∫–∞—Ä—å–µ—Ä–æ–π:\n\n"
        "üß≠ –ü–æ–¥–±–æ—Ä –ø—Ä–æ—Ñ–µ—Å—Å–∏–π ‚Äî –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –∏ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π.\n"
        "üìÑ –°–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∑—é–º–µ ‚Äî —Å–∏–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ –ø–æ–¥ –≤–∞–∫–∞–Ω—Å–∏—é.\n"
        "üßæ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—é–º–µ ‚Äî —Ä–∞–∑–±–æ—Ä –∏ —É–ª—É—á—à–µ–Ω–∏–µ.\n"
        "üé§ HR-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ ‚Äî —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤.\n"
        "üéØ –ü–ª–∞–Ω —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è ‚Äî —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è.\n"
        "üåÄ –°–∏–º–±–∏–æ–∑ —É—Å–ª—É–≥ ‚Äî –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ç—á—ë—Ç.\n"
        "üß† Soft Skills ‚Äî –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –º—è–≥–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤.\n"
        "üìä –ê–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏ ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –æ—Ç–∫–ª–∏–∫.",
        reply_markup=main_keyboard(),
    )


@dp.message(F.text == "‚Ñπ –ò–Ω—Ñ–æ")
async def info(message: Message):
    await message.answer(
        "–ú–æ–∏ —É—Å–ª—É–≥–∏:\n\n"
        "üß≠ –ü–æ–¥–±–æ—Ä –ø—Ä–æ—Ñ–µ—Å—Å–∏–π ‚Äî –∞–Ω–∞–ª–∏–∑ —Ç–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–¥–±–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π.\n"
        "üìÑ –°–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∑—é–º–µ ‚Äî —Ä–µ–∑—é–º–µ —É—Ä–æ–≤–Ω—è HR-–∞–≥–µ–Ω—Ç—Å—Ç–≤–∞.\n"
        "üßæ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—é–º–µ ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä + —É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è.\n"
        "üé§ HR-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ ‚Äî —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å —Ä–∞–∑–±–æ—Ä–æ–º.\n"
        "üéØ –ü–ª–∞–Ω —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ –æ—Ç–≤–µ—Ç—ã.\n"
        "üåÄ –°–∏–º–±–∏–æ–∑ —É—Å–ª—É–≥ ‚Äî –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∫–∞—Ä—å–µ—Ä–Ω—ã–π –æ—Ç—á—ë—Ç.\n"
        "üß† Soft Skills ‚Äî –∞–Ω–∞–ª–∏–∑ –º—è–≥–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.\n"
        "üìä –ê–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏ ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∏ —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç.",
        reply_markup=main_keyboard(),
    )


@dp.message(F.text == "üìú –£—Å–ª–æ–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è")
async def terms(message: Message):
    await message.answer(
        "üìú –£—Å–ª–æ–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:\n\n"
        "‚Ä¢ –ë–æ—Ç –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º –ª–∏—Ü–æ–º –∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º HR-–∞–≥–µ–Ω—Ç—Å—Ç–≤–æ–º.\n"
        "‚Ä¢ –í—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–æ—Å—è—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä.\n"
        "‚Ä¢ –¢—ã —Å–∞–º –ø—Ä–∏–Ω–∏–º–∞–µ—à—å —Ä–µ—à–µ–Ω–∏—è –æ —Å–≤–æ—ë–º —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –∏ –Ω–µ—Å—ë—à—å –∑–∞ –Ω–∏—Ö –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.\n"
        "‚Ä¢ –î–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –∏ –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º.\n"
        "‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É—è –±–æ—Ç–∞, —Ç—ã —Å–æ–≥–ª–∞—à–∞–µ—à—å—Å—è —Å —ç—Ç–∏–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏.",
        reply_markup=main_keyboard(),
    )


@dp.message(F.text == "üß≠ –ü–æ–¥–±–æ—Ä –ø—Ä–æ—Ñ–µ—Å—Å–∏–π")
async def btn_career(message: Message):
    uid = message.from_user.id
    if not check_limit(uid):
        await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
        return
    data = get_user_data(uid)
    data.clear()
    set_state(uid, States.CAREER_ASK_AGE)
    await message.answer("–ù–∞—á–Ω—ë–º —Å –∞–Ω–∫–µ—Ç—ã.\n\n–°–∫–æ–ª—å–∫–æ —Ç–µ–±–µ –ª–µ—Ç?")


@dp.message(F.text == "üìÑ –°–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∑—é–º–µ")
async def btn_resume(message: Message):
    uid = message.from_user.id
    if not check_limit(uid):
        await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
        return
    data = get_user_data(uid)
    data.clear()
    set_state(uid, States.RESUME_ASK_ROLE)
    await message.answer("–î–ª—è –∫–∞–∫–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –Ω—É–∂–Ω–æ —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∑—é–º–µ?")


@dp.message(F.text == "üßæ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—é–º–µ")
async def btn_rescheck(message: Message):
    uid = message.from_user.id
    if not check_limit(uid):
        await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
        return
    data = get_user_data(uid)
    data.clear()
    set_state(uid, States.RESCHECK_ASK_ROLE)
    await message.answer("–ü–æ–¥ –∫–∞–∫—É—é –¥–æ–ª–∂–Ω–æ—Å—Ç—å –±—É–¥–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–∑—é–º–µ?")


@dp.message(F.text == "üé§ HR-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ")
async def btn_mock(message: Message):
    uid = message.from_user.id
    if not check_limit(uid):
        await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
        return
    data = get_user_data(uid)
    data.clear()
    data["mock_answers"] = []
    data["mock_index"] = 0
    set_state(uid, States.HRMOCK_ASK_ROLE)
    await message.answer("–î–ª—è –∫–∞–∫–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ —Ö–æ—á–µ—à—å –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ?")


@dp.message(F.text == "üéØ –ü–ª–∞–Ω —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è")
async def btn_plan(message: Message):
    uid = message.from_user.id
    if not check_limit(uid):
        await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
        return
    data = get_user_data(uid)
    data.clear()
    set_state(uid, States.PLAN_ASK_ROLE)
    await message.answer("–î–ª—è –∫–∞–∫–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –Ω—É–∂–µ–Ω –ø–ª–∞–Ω –ø–æ–≤–µ–¥–µ–Ω–∏—è –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏?")


@dp.message(F.text == "üåÄ –°–∏–º–±–∏–æ–∑ —É—Å–ª—É–≥")
async def btn_symbio(message: Message):
    uid = message.from_user.id
    if not check_limit(uid):
        await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
        return
    data = get_user_data(uid)
    data.clear()
    set_state(uid, States.SYMBIO_ASK_NAME)
    await message.answer("–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç? –ú–æ–∂–Ω–æ –∏–º—è –∏–ª–∏ –Ω–∏–∫.")


@dp.message(F.text == "üß† Soft Skills")
async def btn_soft(message: Message):
    uid = message.from_user.id
    if not check_limit(uid):
        await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
        return
    data = get_user_data(uid)
    data.clear()
    data["soft_answers"] = {}
    set_state(uid, States.SOFT_Q1)
    await message.answer("1/4. –ö–∞–∫ —Ç—ã –æ–±—ã—á–Ω–æ –≤–µ–¥—ë—à—å —Å–µ–±—è –≤ –∫–æ–º–∞–Ω–¥–µ? –õ—é–±–∏—à—å –±—Ä–∞—Ç—å –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É –∏–ª–∏ —Å–∫–æ—Ä–µ–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—à—å –¥—Ä—É–≥–∏—Ö?")


@dp.message(F.text == "üìä –ê–Ω–∞–ª–∏–∑ –≤–∞–∫–∞–Ω—Å–∏–∏")
async def btn_vacancy(message: Message):
    uid = message.from_user.id
    if not check_limit(uid):
        await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
        return
    data = get_user_data(uid)
    data.clear()
    set_state(uid, States.VACANCY_WAIT_TEXT)
    await message.answer(
        "–ü—Ä–∏—à–ª–∏ —Ç–µ–∫—Å—Ç –≤–∞–∫–∞–Ω—Å–∏–∏ (–º–æ–∂–µ—à—å –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ —Å —Å–∞–π—Ç–∞: –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)."
    )


@dp.message(F.document)
async def handle_document(message: Message):
    uid = message.from_user.id
    state = get_state(uid)
    if state != States.RESCHECK_WAIT_TEXT:
        await message.answer("–°–µ–π—á–∞—Å —è –Ω–µ –æ–∂–∏–¥–∞—é —Ñ–∞–π–ª. –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—é–º–µ, –≤—ã–±–µ—Ä–∏ ¬´üßæ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—é–º–µ¬ª.")
        return

    if not check_limit(uid):
        await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
        return

    doc: Document = message.document
    tmp_path = f"/tmp/{doc.file_unique_id}_{doc.file_name}"
    await doc.download(destination=tmp_path)

    text = extract_text_from_file(tmp_path)
    try:
        os.remove(tmp_path)
    except Exception:
        pass

    data = get_user_data(uid)
    role = data.get("rescheck_role", "–∂–µ–ª–∞–µ–º–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å")

    await message.answer("–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ä–µ–∑—é–º–µ –∫–∞–∫ HR‚Ä¶")
    user_prompt = f"–î–æ–ª–∂–Ω–æ—Å—Ç—å: {role}\n\n–¢–µ–∫—Å—Ç —Ä–µ–∑—é–º–µ:\n{text}"
    review = await call_openai_chat(PROMPT_RESCHECK, user_prompt, temperature=0.5)
    set_state(uid, States.NONE)
    inc_limit(uid)
    await send_long_message(message, review, reply_markup=main_keyboard())
    await message.answer(
        "–•–æ—á–µ—à—å —É—Å–∏–ª–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç? –ú–æ–≥—É:\n"
        "‚Ä¢ üéØ –¥–∞—Ç—å –ø–ª–∞–Ω —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–¥ —ç—Ç—É –¥–æ–ª–∂–Ω–æ—Å—Ç—å,\n"
        "‚Ä¢ üé§ –ø—Ä–æ–≤–µ—Å—Ç–∏ HR-–º–æ–∫ –∏–Ω—Ç–µ—Ä–≤—å—é.",
        reply_markup=main_keyboard(),
    )


@dp.message(F.voice)
async def handle_voice(message: Message):
    uid = message.from_user.id
    if not check_limit(uid):
        await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
        return

    tmp_path = f"/tmp/voice_{message.voice.file_unique_id}.ogg"
    await message.voice.download(destination=tmp_path)

    try:
        with open(tmp_path, "rb") as audio_file:
            result = await asyncio.to_thread(
                openai.Audio.transcribe,
                "whisper-1",
                audio_file,
                language="ru",
            )
        text = result.get("text", "").strip()
    except Exception as e:
        logging.exception("Whisper error")
        text = ""
    try:
        os.remove(tmp_path)
    except Exception:
        pass

    if not text:
        await message.answer("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –≥–æ–ª–æ—Å. –ü–æ–ø—Ä–æ–±—É–π —Å–∫–∞–∑–∞—Ç—å —á—É—Ç—å —á—ë—Ç—á–µ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å —Ç–µ–∫—Å—Ç–æ–º.")
        return

    await process_input(message, text)


@dp.message(F.text)
async def handle_text(message: Message):
    text = message.text.strip()
    await process_input(message, text)


async def process_input(message: Message, text: str):
    uid = message.from_user.id
    state = get_state(uid)
    data = get_user_data(uid)

    if state == States.CAREER_ASK_AGE:
        data["age"] = text
        set_state(uid, States.CAREER_ASK_EDU)
        await message.answer("–ö–∞–∫–æ–µ —É —Ç–µ–±—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ? (—à–∫–æ–ª–∞, –∫–æ–ª–ª–µ–¥–∂, –≤—É–∑, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å)")
        return

    if state == States.CAREER_ASK_EDU:
        data["education"] = text
        set_state(uid, States.CAREER_ASK_SKILLS)
        await message.answer("–ü–µ—Ä–µ—á–∏—Å–ª–∏ —Å–≤–æ–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é.")
        return

    if state == States.CAREER_ASK_SKILLS:
        data["skills"] = text
        set_state(uid, States.CAREER_ASK_EXP)
        await message.answer("–†–∞—Å—Å–∫–∞–∂–∏ –∫–æ—Ä–æ—Ç–∫–æ –ø—Ä–æ –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã –∏–ª–∏ —É—á–µ–±–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã. –ï—Å–ª–∏ –æ–ø—ã—Ç–∞ –Ω–µ—Ç ‚Äî —Ç–∞–∫ –∏ –Ω–∞–ø–∏—à–∏.")
        return

    if state == States.CAREER_ASK_EXP:
        data["experience"] = text
        set_state(uid, States.CAREER_ASK_GOAL)
        await message.answer("–í –∫–∞–∫—É—é —Å—Ç–æ—Ä–æ–Ω—É —Ö–æ—á–µ—à—å —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è? –ö–∞–∫–∏–µ —Ü–µ–ª–∏ –∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã –≤ –∫–∞—Ä—å–µ—Ä–µ?")
        return

    if state == States.CAREER_ASK_GOAL:
        data["goal"] = text
        set_state(uid, States.NONE)
        if not check_limit(uid):
            await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
            return
        await message.answer("–î—É–º–∞—é –Ω–∞–¥ —Ç–≤–æ–∏–º –ø—Ä–æ—Ñ–∏–ª–µ–º‚Ä¶")
        user_prompt = (
            f"–í–æ–∑—Ä–∞—Å—Ç: {data.get('age')}\n"
            f"–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ: {data.get('education')}\n"
            f"–ù–∞–≤—ã–∫–∏: {data.get('skills')}\n"
            f"–û–ø—ã—Ç: {data.get('experience')}\n"
            f"–¶–µ–ª–∏ –∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã: {data.get('goal')}\n"
        )
        reply = await call_openai_chat(PROMPT_CAREER, user_prompt, temperature=0.5)
        inc_limit(uid)
        await send_long_message(message, reply, reply_markup=main_keyboard())
        await message.answer(
            "–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:\n"
            "‚Ä¢ –º–æ–∂–µ—à—å —Å–¥–µ–ª–∞—Ç—å üìÑ —Ä–µ–∑—é–º–µ –ø–æ–¥ –æ–¥–Ω–æ –∏–∑ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π,\n"
            "‚Ä¢ –∏–ª–∏ –ø—Ä–æ–π—Ç–∏ üß† Soft Skills, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å —Å–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –≥–ª—É–±–∂–µ.",
            reply_markup=main_keyboard(),
        )
        return

    if state == States.RESUME_ASK_ROLE:
        data["resume_role"] = text
        set_state(uid, States.RESUME_ASK_CONTACTS)
        await message.answer("–ù–∞–ø–∏—à–∏ –§–ò–û (–µ—Å–ª–∏ —Ö–æ—á–µ—à—å) –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã: —Ç–µ–ª–µ—Ñ–æ–Ω, –ø–æ—á—Ç–∞, —Ç–µ–ª–µ–≥—Ä–∞–º.")
        return

    if state == States.RESUME_ASK_CONTACTS:
        data["resume_contacts"] = text
        set_state(uid, States.RESUME_ASK_CITY)
        await message.answer("–í –∫–∞–∫–æ–º –≥–æ—Ä–æ–¥–µ —Ç—ã –Ω–∞—Ö–æ–¥–∏—à—å—Å—è?")
        return

    if state == States.RESUME_ASK_CITY:
        data["resume_city"] = text
        set_state(uid, States.RESUME_ASK_EDU)
        await message.answer("–û–ø–∏—à–∏ —Å–≤–æ—ë –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ: —É—á–µ–±–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è, –≥–æ–¥—ã, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏.")
        return

    if state == States.RESUME_ASK_EDU:
        data["resume_education"] = text
        set_state(uid, States.RESUME_ASK_EXP)
        await message.answer("–û–ø–∏—à–∏ –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã: –º–µ—Å—Ç–∞, –¥–æ–ª–∂–Ω–æ—Å—Ç–∏, –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –ï—Å–ª–∏ –æ–ø—ã—Ç–∞ –Ω–µ—Ç ‚Äî –Ω–∞–ø–∏—à–∏ –ø—Ä–æ —É—á–µ–±–Ω—ã–µ/–ª–∏—á–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã.")
        return

    if state == States.RESUME_ASK_EXP:
        data["resume_experience"] = text
        set_state(uid, States.RESUME_ASK_SKILLS)
        await message.answer("–ü–µ—Ä–µ—á–∏—Å–ª–∏ —Å–≤–æ–∏ –∫–ª—é—á–µ–≤—ã–µ –Ω–∞–≤—ã–∫–∏: –∏ –∂—ë—Å—Ç–∫–∏–µ, –∏ –º—è–≥–∫–∏–µ.")
        return

    if state == States.RESUME_ASK_SKILLS:
        data["resume_skills"] = text
        set_state(uid, States.RESUME_ASK_ACH)
        await message.answer("–†–∞—Å—Å–∫–∞–∂–∏ –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö: –ø—Ä–æ–µ–∫—Ç—ã, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —Ü–∏—Ñ—Ä—ã, –ø–æ–±–µ–¥—ã.")
        return

    if state == States.RESUME_ASK_ACH:
        data["resume_achievements"] = text
        set_state(uid, States.RESUME_ASK_EXTRA)
        await message.answer("–ï—Å—Ç—å –ª–∏ –∫—É—Ä—Å—ã, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–ª–∏ –≤–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏?")
        return

    if state == States.RESUME_ASK_EXTRA:
        data["resume_extra"] = text
        set_state(uid, States.NONE)
        if not check_limit(uid):
            await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
            return
        await message.answer("–°–æ—Å—Ç–∞–≤–ª—è—é —Ä–µ–∑—é–º–µ‚Ä¶")
        user_prompt = (
            f"–¶–µ–ª–µ–≤–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å: {data.get('resume_role')}\n\n"
            f"–§–ò–û –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã: {data.get('resume_contacts')}\n"
            f"–ì–æ—Ä–æ–¥: {data.get('resume_city')}\n"
            f"–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ: {data.get('resume_education')}\n"
            f"–û–ø—ã—Ç: {data.get('resume_experience')}\n"
            f"–ù–∞–≤—ã–∫–∏: {data.get('resume_skills')}\n"
            f"–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è: {data.get('resume_achievements')}\n"
            f"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: {data.get('resume_extra')}\n"
        )
        resume_text = await call_openai_chat(PROMPT_RESUME, user_prompt, temperature=0.4)
        inc_limit(uid)
        await send_long_message(message, resume_text, reply_markup=main_keyboard())
        await message.answer(
            "–î–∞–ª—å—à–µ –º–æ–∂–Ω–æ:\n"
            "‚Ä¢ –ø—Ä–æ–π—Ç–∏ üßæ –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–µ–∑—é–º–µ,\n"
            "‚Ä¢ –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å üé§ HR-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ —ç—Ç–æ–º—É —Ä–µ–∑—é–º–µ.",
            reply_markup=main_keyboard(),
        )
        return

    if state == States.RESCHECK_ASK_ROLE:
        data["rescheck_role"] = text
        set_state(uid, States.RESCHECK_WAIT_TEXT)
        await message.answer(
            "–¢–µ–ø–µ—Ä—å –ø—Ä–∏—à–ª–∏ —Å–≤–æ—ë —Ä–µ–∑—é–º–µ:\n"
            "‚Ä¢ –ª–∏–±–æ —Ç–µ–∫—Å—Ç–æ–º –≤ —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏,\n"
            "‚Ä¢ –ª–∏–±–æ —Ñ–∞–π–ª–æ–º PDF / DOCX.",
        )
        return

    if state == States.RESCHECK_WAIT_TEXT:
        if not check_limit(uid):
            await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
            return
        role = data.get("rescheck_role", "–∂–µ–ª–∞–µ–º–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å")
        await message.answer("–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ä–µ–∑—é–º–µ –∫–∞–∫ HR‚Ä¶")
        user_prompt = f"–î–æ–ª–∂–Ω–æ—Å—Ç—å: {role}\n\n–¢–µ–∫—Å—Ç —Ä–µ–∑—é–º–µ:\n{text}"
        review = await call_openai_chat(PROMPT_RESCHECK, user_prompt, temperature=0.5)
        set_state(uid, States.NONE)
        inc_limit(uid)
        await send_long_message(message, review, reply_markup=main_keyboard())
        await message.answer(
            "–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:\n"
            "‚Ä¢ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ üé§ HR-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ,\n"
            "‚Ä¢ –∏–ª–∏ –ø–æ–ª—É—á–∏—Ç—å üéØ –ø–ª–∞–Ω —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è.",
            reply_markup=main_keyboard(),
        )
        return

    if state == States.HRMOCK_ASK_ROLE:
        data["mock_role"] = text
        data["mock_answers"] = []
        data["mock_index"] = 0
        set_state(uid, States.HRMOCK_Q)
        await message.answer(
            "–ü—Ä–æ–≤–µ–¥—ë–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ HR-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ.\n"
            "–û—Ç–≤–µ—á–∞–π —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –∫–∞–∫ –Ω–∞ –Ω–∞—Å—Ç–æ—è—â–µ–º –∏–Ω—Ç–µ—Ä–≤—å—é.\n\n"
            f"–í–æ–ø—Ä–æ—Å 1: {HR_INTRO_QUESTIONS[0]}"
        )
        return

    if state == States.HRMOCK_Q:
        answers: List[str] = data.get("mock_answers", [])
        idx: int = data.get("mock_index", 0)
        if idx < len(HR_INTRO_QUESTIONS):
            answers.append(text)
            data["mock_answers"] = answers
            idx += 1
            data["mock_index"] = idx

        if idx < len(HR_INTRO_QUESTIONS):
            await message.answer(f"–í–æ–ø—Ä–æ—Å {idx + 1}: {HR_INTRO_QUESTIONS[idx]}")
        else:
            set_state(uid, States.NONE)
            if not check_limit(uid):
                await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
                return
            role = data.get("mock_role", "–∂–µ–ª–∞–µ–º–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å")
            await message.answer("–°–ø–∞—Å–∏–±–æ, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ç–≤–æ–∏ –æ—Ç–≤–µ—Ç—ã‚Ä¶")
            joined_answers = ""
            for i, (q, ans) in enumerate(zip(HR_INTRO_QUESTIONS, answers), start=1):
                joined_answers += f"–í–æ–ø—Ä–æ—Å {i}: {q}\n–û—Ç–≤–µ—Ç: {ans}\n\n"
            user_prompt = f"–î–æ–ª–∂–Ω–æ—Å—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞: {role}\n\n–û—Ç–≤–µ—Ç—ã –∫–∞–Ω–¥–∏–¥–∞—Ç–∞:\n{joined_answers}"
            review = await call_openai_chat(PROMPT_MOCK, user_prompt, temperature=0.6)
            inc_limit(uid)
            await send_long_message(message, review, reply_markup=main_keyboard())
            await message.answer(
                "–ú–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:\n"
                "‚Ä¢ –ø–æ–ª—É—á–∏—Ç—å üéØ –ø–ª–∞–Ω —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è,\n"
                "‚Ä¢ –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å üìä –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∞–∫–∞–Ω—Å–∏–∏.",
                reply_markup=main_keyboard(),
            )
        return

    if state == States.PLAN_ASK_ROLE:
        data["plan_role"] = text
        set_state(uid, States.PLAN_ASK_COMPANY)
        await message.answer("–î–ª—è –∫–∞–∫–æ–≥–æ —Ç–∏–ø–∞ –∫–æ–º–ø–∞–Ω–∏–∏? (–∫—Ä—É–ø–Ω–∞—è, —Å—Ç–∞—Ä—Ç–∞–ø, –≥–æ—Å–∫–æ–º–ø–∞–Ω–∏—è, –Ω–µ –≤–∞–∂–Ω–æ –∏ —Ç.–ø.)")
        return

    if state == States.PLAN_ASK_COMPANY:
        data["plan_company"] = text
        set_state(uid, States.PLAN_ASK_FEARS)
        await message.answer("–ß—Ç–æ —Ç–µ–±—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø—É–≥–∞–µ—Ç –∏–ª–∏ –Ω–∞–ø—Ä—è–≥–∞–µ—Ç –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è—Ö?")
        return

    if state == States.PLAN_ASK_FEARS:
        data["plan_fears"] = text
        set_state(uid, States.PLAN_ASK_STRENGTHS)
        await message.answer("–ö–∞–∫–∏–µ —Å–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã —Ç—ã —Å—á–∏—Ç–∞–µ—à—å –≤–∞–∂–Ω—ã–º–∏ –¥–ª—è —ç—Ç–æ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–∏?")
        return

    if state == States.PLAN_ASK_STRENGTHS:
        data["plan_strengths"] = text
        set_state(uid, States.PLAN_ASK_EXTRA)
        await message.answer("–ï—Å—Ç—å –ª–∏ –µ—â—ë —á—Ç–æ-—Ç–æ –≤–∞–∂–Ω–æ–µ –æ —Ç–µ–±–µ, —á—Ç–æ —Å—Ç–æ–∏—Ç —É—á–µ—Å—Ç—å?")
        return

    if state == States.PLAN_ASK_EXTRA:
        data["plan_extra"] = text
        set_state(uid, States.NONE)
        if not check_limit(uid):
            await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
            return
        await message.answer("–ì–æ—Ç–æ–≤–ª—é –ø–ª–∞–Ω –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏‚Ä¶")
        user_prompt = (
            f"–¶–µ–ª–µ–≤–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å: {data.get('plan_role')}\n"
            f"–¢–∏–ø –∫–æ–º–ø–∞–Ω–∏–∏: {data.get('plan_company')}\n"
            f"–°—Ç—Ä–∞—Ö–∏ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: {data.get('plan_fears')}\n"
            f"–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã: {data.get('plan_strengths')}\n"
            f"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: {data.get('plan_extra')}\n"
        )
        plan = await call_openai_chat(PROMPT_PLAN, user_prompt, temperature=0.5)
        inc_limit(uid)
        await send_long_message(message, plan, reply_markup=main_keyboard())
        await message.answer(
            "–î–∞–ª—å—à–µ –º–æ–∂–Ω–æ:\n"
            "‚Ä¢ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ—é –≤–∞–∫–∞–Ω—Å–∏—é —á–µ—Ä–µ–∑ üìä –∞–Ω–∞–ª–∏–∑,\n"
            "‚Ä¢ –∏–ª–∏ –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã —á–µ—Ä–µ–∑ üé§ HR-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ.",
            reply_markup=main_keyboard(),
        )
        return

    if state == States.SYMBIO_ASK_NAME:
        data["sym_name"] = text
        set_state(uid, States.SYMBIO_ASK_AGE)
        await message.answer("–°–∫–æ–ª—å–∫–æ —Ç–µ–±–µ –ª–µ—Ç?")
        return

    if state == States.SYMBIO_ASK_AGE:
        data["sym_age"] = text
        set_state(uid, States.SYMBIO_ASK_ROLE)
        await message.answer("–ö–∞–∫–∞—è —É —Ç–µ–±—è —Ü–µ–ª–µ–≤–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å –∏–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ? (–Ω–∞–ø—Ä–∏–º–µ—Ä: –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥, –∞–Ω–∞–ª–∏—Ç–∏–∫, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–¥–∞–∂)")
        return

    if state == States.SYMBIO_ASK_ROLE:
        data["sym_role"] = text
        set_state(uid, States.SYMBIO_ASK_EXP)
        await message.answer("–†–∞—Å—Å–∫–∞–∂–∏ –∫—Ä–∞—Ç–∫–æ –ø—Ä–æ —Å–≤–æ–π –æ–ø—ã—Ç: —Ä–∞–±–æ—Ç–∞, –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∏, –ø—Ä–æ–µ–∫—Ç—ã, —É—á—ë–±–∞.")
        return

    if state == States.SYMBIO_ASK_EXP:
        data["sym_exp"] = text
        set_state(uid, States.SYMBIO_ASK_SKILLS)
        await message.answer("–ü–µ—Ä–µ—á–∏—Å–ª–∏ —Å–≤–æ–∏ –∫–ª—é—á–µ–≤—ã–µ –Ω–∞–≤—ã–∫–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é.")
        return

    if state == States.SYMBIO_ASK_SKILLS:
        data["sym_skills"] = text
        set_state(uid, States.SYMBIO_ASK_FEARS)
        await message.answer("–ß—Ç–æ —Ç–µ–±—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –≤–æ–ª–Ω—É–µ—Ç/–ø—É–≥–∞–µ—Ç –≤ –ø–æ–∏—Å–∫–µ —Ä–∞–±–æ—Ç—ã –∏ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è—Ö?")
        return

    if state == States.SYMBIO_ASK_FEARS:
        data["sym_fears"] = text
        set_state(uid, States.SYMBIO_ASK_EXTRA)
        await message.answer("–ï—Å—Ç—å –ª–∏ –µ—â—ë –≤–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–±–µ, –∫–æ—Ç–æ—Ä—É—é —Å—Ç–æ–∏—Ç —É—á–µ—Å—Ç—å? (–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, —Ü–µ–ª–∏)")
        return

    if state == States.SYMBIO_ASK_EXTRA:
        data["sym_extra"] = text
        set_state(uid, States.NONE)
        if not check_limit(uid):
            await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
            return
        await message.answer("–ì–æ—Ç–æ–≤–ª—é –¥–ª—è —Ç–µ–±—è –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∫–∞—Ä—å–µ—Ä–Ω—ã–π –æ—Ç—á—ë—Ç‚Ä¶")
        user_prompt = (
            f"–ò–º—è: {data.get('sym_name')}\n"
            f"–í–æ–∑—Ä–∞—Å—Ç: {data.get('sym_age')}\n"
            f"–¶–µ–ª–µ–≤–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å/–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: {data.get('sym_role')}\n"
            f"–û–ø—ã—Ç: {data.get('sym_exp')}\n"
            f"–ù–∞–≤—ã–∫–∏: {data.get('sym_skills')}\n"
            f"–°—Ç—Ä–∞—Ö–∏ –∏ –≤–æ–ª–Ω–µ–Ω–∏—è: {data.get('sym_fears')}\n"
            f"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: {data.get('sym_extra')}\n"
        )
        report = await call_openai_chat(PROMPT_SYMBIO, user_prompt, temperature=0.5)
        inc_limit(uid)
        await send_long_message(message, report, reply_markup=main_keyboard())
        await message.answer(
            "–° —ç—Ç–∏–º –æ—Ç—á—ë—Ç–æ–º –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ:\n"
            "‚Ä¢ —Å–¥–µ–ª–∞—Ç—å üìÑ —Ä–µ–∑—é–º–µ,\n"
            "‚Ä¢ –ø—Ä–æ–π—Ç–∏ üé§ HR-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ,\n"
            "‚Ä¢ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é üìä –≤–∞–∫–∞–Ω—Å–∏—é.",
            reply_markup=main_keyboard(),
        )
        return

    if state == States.SOFT_Q1:
        data.setdefault("soft_answers", {})["q1"] = text
        set_state(uid, States.SOFT_Q2)
        await message.answer("2/4. –ö–∞–∫ —Ç—ã –æ–±—ã—á–Ω–æ —Ä–µ–∞–≥–∏—Ä—É–µ—à—å –Ω–∞ —Å—Ç—Ä–µ—Å—Å–æ–≤—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –∏ –¥–µ–¥–ª–∞–π–Ω—ã?")
        return

    if state == States.SOFT_Q2:
        data.setdefault("soft_answers", {})["q2"] = text
        set_state(uid, States.SOFT_Q3)
        await message.answer("3/4. –†–∞—Å—Å–∫–∞–∂–∏ –æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ (–Ω–∞ —É—á—ë–±–µ/—Ä–∞–±–æ—Ç–µ) –∏ –∫–∞–∫ —Ç—ã –µ—ë —Ä–µ—à–∞–ª(–∞).")
        return

    if state == States.SOFT_Q3:
        data.setdefault("soft_answers", {})["q3"] = text
        set_state(uid, States.SOFT_Q4)
        await message.answer("4/4. –ù–∞—Å–∫–æ–ª—å–∫–æ —Ç–µ–±–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –±—Ä–∞—Ç—å –Ω–∞ —Å–µ–±—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É?")
        return

    if state == States.SOFT_Q4:
        data.setdefault("soft_answers", {})["q4"] = text
        set_state(uid, States.NONE)
        if not check_limit(uid):
            await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
            return
        await message.answer("–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ç–≤–æ–∏ –æ—Ç–≤–µ—Ç—ã –∏ soft skills‚Ä¶")
        sa = data.get("soft_answers", {})
        user_prompt = (
            f"–û—Ç–≤–µ—Ç 1: {sa.get('q1')}\n"
            f"–û—Ç–≤–µ—Ç 2: {sa.get('q2')}\n"
            f"–û—Ç–≤–µ—Ç 3: {sa.get('q3')}\n"
            f"–û—Ç–≤–µ—Ç 4: {sa.get('q4')}\n"
        )
        result = await call_openai_chat(PROMPT_SOFT, user_prompt, temperature=0.5)
        inc_limit(uid)
        await send_long_message(message, result, reply_markup=main_keyboard())
        await message.answer(
            "–î–∞–ª—å—à–µ –º–æ–∂–Ω–æ:\n"
            "‚Ä¢ —Å–¥–µ–ª–∞—Ç—å üß≠ –ø–æ–¥–±–æ—Ä –ø—Ä–æ—Ñ–µ—Å—Å–∏–π,\n"
            "‚Ä¢ –∏–ª–∏ —Å–æ—Å—Ç–∞–≤–∏—Ç—å üìÑ —Ä–µ–∑—é–º–µ —Å —É—á—ë—Ç–æ–º —Ç–≤–æ–∏—Ö —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω.",
            reply_markup=main_keyboard(),
        )
        return

    if state == States.VACANCY_WAIT_TEXT:
        data["vacancy_text"] = text
        set_state(uid, States.VACANCY_WAIT_PROFILE)
        await message.answer("–¢–µ–ø–µ—Ä—å –æ–ø–∏—à–∏ –∫—Ä–∞—Ç–∫–æ —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏ –∏ –æ–ø—ã—Ç, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã —Å—á–∏—Ç–∞–µ—à—å –≤–∞–∂–Ω—ã–º–∏ –ø–æ–¥ —ç—Ç—É –≤–∞–∫–∞–Ω—Å–∏—é.")
        return

    if state == States.VACANCY_WAIT_PROFILE:
        data["vacancy_profile"] = text
        set_state(uid, States.NONE)
        if not check_limit(uid):
            await message.answer("–ù–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π –∑–∞–≤—Ç—Ä–∞.", reply_markup=main_keyboard())
            return
        await message.answer("–°—Ä–∞–≤–Ω–∏–≤–∞—é —Ç–µ–±—è —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –≤–∞–∫–∞–Ω—Å–∏–∏‚Ä¶")
        user_prompt = (
            f"–¢–µ–∫—Å—Ç –≤–∞–∫–∞–Ω—Å–∏–∏:\n{data.get('vacancy_text')}\n\n"
            f"–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–≤—ã–∫–∏, –æ–ø—ã—Ç):\n{data.get('vacancy_profile')}\n"
        )
        result = await call_openai_chat(PROMPT_VACANCY, user_prompt, temperature=0.5)
        inc_limit(uid)
        await send_long_message(message, result, reply_markup=main_keyboard())
        await message.answer(
            "–î–∞–ª—å—à–µ –º–æ–∂–Ω–æ:\n"
            "‚Ä¢ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å üìÑ —Ä–µ–∑—é–º–µ –ø–æ–¥ —ç—Ç—É –≤–∞–∫–∞–Ω—Å–∏—é,\n"
            "‚Ä¢ –∏–ª–∏ –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã —á–µ—Ä–µ–∑ üé§ HR-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ.",
            reply_markup=main_keyboard(),
        )
        return

    await message.answer(
        "–Ø —Ç–µ–±—è –ø–æ–Ω—è–ª, –Ω–æ —Å–µ–π—á–∞—Å –Ω–µ –≤ —Ä–µ–∂–∏–º–µ –¥–∏–∞–ª–æ–≥–∞.\n"
        "–í—ã–±–µ—Ä–∏ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –º–µ–Ω—é –∏–ª–∏ –Ω–∞–ø–∏—à–∏ /start.",
        reply_markup=main_keyboard(),
    )


async def main():
    logging.info("–ó–∞–ø—É—Å–∫ –∫–∞—Ä—å–µ—Ä–Ω–æ–≥–æ –±–æ—Ç–∞‚Ä¶")
    await dp.start_polling(bot)


if __name__ == "__main__":
    asyncio.run(main())
